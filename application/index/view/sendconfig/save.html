<!----该文件是打开窗体之后的页面-->
<?php
$page_id="sendconfig_save";
?>
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">×</span>
    </button>
    <h4 class="modal-title">
        <i class="fa fa-plug"></i> 添加配置
    </h4>
</div>
<div class="modal-body">
    <form class="form-horizontal" id="{$page_id}_toaction" onsubmit="return false">
        <input type="hidden" name="token" value="{$token}">
        <input type="hidden" name="id" value="{$data.id}">
        <div class="form-group">
            <label for="" class="control-label col-sm-3">标题：</label>
            <div class="col-sm-4">
                <input type="text" class="form-control" name="title" value="{$data.title}">
            </div>
        </div>
        <div class="form-group">
            <label for="" class="control-label col-sm-3">省份：</label>
            <div class="col-sm-4">
                <input type="text" id="{$page_id}_province" value="{$data.province_id}">
            </div>
        </div>

        <div class="form-group">
            <label for="" class="control-label col-sm-3">品牌：</label>
            <div class="col-sm-4">
                <input type="text" id="{$page_id}_brand" value="{$data.brand_id}">
            </div>
        </div>
        <div class="form-group">
            <label for="" class="control-label col-sm-3">模板：</label>
            <div class="col-sm-4">
                <input type="text" id="{$page_id}_template" value="{$data.template_id}">
            </div>
        </div>
    </form>
    <input type="hidden" value="{$modal_id}" name='{$page_id}_add_producttype_modal_id'>
    <input type="hidden" value="{$datagrid_id}" name='{$page_id}_datagrid_id'>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">关闭</button>
    <button type="button" class="btn btn-primary btn-sm" id="{$page_id}_add_producttype_btn">保存</button>
</div>
<script>
    //省份
    $("#{$page_id}_province").combotree({
        url:obj.province,
        width:"200px",
    });

    //品牌
    $("#{$page_id}_brand").combotree({
        url:obj.brand,
        width:"200px"
    });

    //模板
    $("#{$page_id}_template").combotree({
        url:obj.template,
        multiple:true,
        width:"200px"
    });

    $("#{$page_id}_add_producttype_btn").click(function () {
        var obj = {
            add_email_template_url: "{:URL('index/Sendconfig/saveData')}"
        };
        var data = $("#{$page_id}_toaction").serializeArray();
        data.push({
            name: "province_id",
            value: $("#{$page_id}_province").combotree("getValue"),
        });
        data.push({
            name: "province_name",
            value: $("#{$page_id}_province").combotree("getText"),
        });
        data.push({
            name:"brand_id",
            value: $("#{$page_id}_brand").combotree("getValue"),
        });
        data.push({
            name:"brand_name",
            value: $("#{$page_id}_brand").combotree("getText"),
        });
        data.push({
            name:"template_id",
            value: $("#{$page_id}_template").combotree("getValues"),
        });
        data.push({
            name:"template_name",
            value: $("#{$page_id}_template").combotree("getText"),
        });
        submit_form(obj.add_email_template_url, data, $("input[name='{$page_id}_add_producttype_modal_id']").val(), $("input[name='{$page_id}_datagrid_id']").val());
    });
</script>
